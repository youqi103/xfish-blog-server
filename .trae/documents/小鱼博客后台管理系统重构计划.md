# 小鱼博客后台管理系统重构计划

## 1. 重构目标
- 适应新的数据库表结构
- 实现5个核心模块的接口
- 保持代码的可维护性和扩展性

## 2. 重构内容

### 2.1 实体类重构
- **User**：修改表名映射为 `sys_user`，调整字段（role → user_type，状态字段含义调整）
- **Article**：调整字段结构，移除 `tags` 和 `allowComment` 字段
- **Comment**：简化审核相关字段，调整字段名称
- **新增 UserBehavior**：实现用户行为记录实体
- **新增 SysConfig**：实现系统配置实体
- **新增 Category**：完善分类实体（已有表结构但需要确认）

### 2.2 Mapper 层重构
- 修改现有 Mapper 接口的表名映射
- 调整 Mapper 方法以适应新的字段结构
- 新增 `UserBehaviorMapper` 和 `SysConfigMapper`

### 2.3 Service 层重构
- 调整现有 Service 方法以适应新的实体结构
- 实现行为统计相关功能
- 实现系统配置管理功能

### 2.4 Controller 层重构
- 确保所有接口符合新的业务逻辑
- 调整请求和响应参数

### 2.5 配置文件调整
- 确保数据库连接配置正确
- 调整 MyBatis-Plus 配置

## 3. 模块实现

### 3.1 用户管理模块
- 用户增删查改
- 权限赋予（基于 user_type 字段）
- 状态管理

### 3.2 文章管理模块
- 文章增删查改
- 状态管理（草稿、已发布、已下线）
- 置顶功能

### 3.3 评论管理模块
- 评论增删查改
- 审核功能（待审核、审核通过、审核驳回）
- 评论回复功能

### 3.4 行为统计模块
- 访问统计
- 点赞统计
- 评论统计

### 3.5 系统配置模块
- 配置项增删查改
- 配置项分类管理

## 4. 重构步骤

1. **调整实体类**：根据新的数据库表结构修改现有实体类，新增缺失的实体类
2. **更新 Mapper 层**：调整表名映射和方法
3. **重构 Service 层**：实现新的业务逻辑
4. **调整 Controller 层**：确保接口符合新的业务逻辑
5. **测试验证**：确保所有功能正常工作

## 5. 技术栈
- Spring Boot 2.6.13
- MyBatis-Plus 3.5.4.1
- MySQL 8.0
- Lombok

## 6. 注意事项
- 保持代码风格一致
- 新增必要的注释
- 确保数据库外键约束正确
- 实现合理的异常处理
- 确保接口的安全性

## 7. 预期成果
- 系统能够正常运行
- 所有模块接口实现完成
- 代码结构清晰，易于维护和扩展